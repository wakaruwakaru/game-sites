<html>
<head>
<meta charset="utf-8">
<title>将棋</title>
<link rel="stylesheet" href="./css/main.css">
<link rel="shortcut icon" href="/game-sites/index/icon/icon1.png" >
<meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body>

<div id="main_holder">
<header id="main_header">
<nav><ul id="header_nav_items"></ul></nav></header>
<section id="main_contents">
<article id="contents_article">
﻿<h1>将棋</h1>
<script src="./js/id0001.js"></script>
<script src="./js/id0002.js"></script>
<script src="./js/id0003.js"></script>
<script src="./js/id0004.js"></script>
<script src="./js/id0005.js"></script>
<script src="./js/id0006.js"></script>
<script src="./js/id0007.js"></script>
<script src="./js/id0008.js"></script>
<script src="./js/id0009.js"></script>
<script src="./js/id0010.js"></script>
<script src="./js/id0011.js"></script>
<script src="./js/id0012.js"></script>
<script src="./js/id0013.js"></script>
<script>
function sg99a_init() {
  var width = document.getElementById('sg99a').clientWidth;
  var game = new SG99A(document.getElementById('sg99a'), 0, 0, width, Math.floor(width * 1.5));
}
window.addEventListener('load', sg99a_init);
</script>

<div id="sg99a" style="padding: 0; margin: 0; width: 100%; max-width: 600px; margin-left: auto; margin-right: auto;">
</div>

<p>Web Workersが実装されていないブラウザでは、CPUのレベルは1のみ選択可能になります。</p>
<div id="contents_footer_ad">
<script src="./js/googlesyndication.js"></script>
<!-- auto_banner -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-3500802105933440"
     data-ad-slot="9609810374"
     data-ad-format="auto"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
</div>
<hr>
</article>
<aside id="contents_aside_a">
<div id="aside_ad">
<script src="./js/id0014.js"></script>
<!-- auto_banner -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-3500802105933440"
     data-ad-slot="9609810374"
     data-ad-format="auto"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
</div></aside>
<aside id="contents_aside_b">
</aside>
</section>
<footer id="main_footer">
<p id="main_footer_info"></p>
</footer>
</div>
<div id="reloadBtn" class="floating-btn" onclick="reload()">↻</div>
<div id="logoutBtn" class="floating-btn" onclick="backPage()">⇦</div>
<script>
    const urlParams = new URLSearchParams(location.search);
    const token1 = urlParams.get("key1");
  	const token3 = localStorage.getItem("account1");
    localStorage.setItem("account1", "");
    if((token1 !== localStorage.getItem("key1")) || (token3 == "") || (token3 == null)){
        localStorage.setItem("key1", "unauthorized");
	    localStorage.setItem("requestPage1", "game/page0002/page0002");
        location.href = "/game-sites/";
    }else{
        localStorage.setItem("key1", "");
	    localStorage.setItem("requestPage1", "");
        setInterval(() => {
            sendToGAS(token3, "", "page");
        }, 5000);
    }

    /* ======== Google Apps Script Web App URL ======== */
    const WEB_APP_URL =
      "https://script.google.com/macros/s/AKfycbyU69VodYxnQJxMI4BhpCnVyvSlFcdM54XFnio5y8A02Uf_P__36zrWbpwih_Wc3szYHw/exec";
    /* ======== GASに送信する処理 ======== */
    async function sendToGAS(User, text, status){
      const payload = {
        user: User,
        message: text,
        status
      };
      try {
        await fetch(WEB_APP_URL, {
          method: "POST",
          mode: "no-cors",   // ← GAS が CORS 許可してないため必要
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify(payload)
        });
      } catch (e) {
        console.error("送信エラー:", e);
      }
	}

    function reload(){
        const key1 = crypto.randomUUID();
        localStorage.setItem("key1", key1);
		localStorage.setItem("account1", token3);
        location.href = "/game-sites/game/page0002/page0002?key1=" + key1;
    }
    function backPage(){
        const key1 = crypto.randomUUID();
        localStorage.setItem("key1", key1);
	    localStorage.setItem("account1", token3);
        location.href = "/game-sites/top/top0001/top0001?key1=" + key1;
    }
    </script>
  </body>
</html>
