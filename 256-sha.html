<html>
  <head>
  </head>
  <body>

    <input type="text" id="pass" placeholder="pass" />
    <button id="gen">Generate</button>
    <div id="log1"></div>
    <div id="log2"></div>
    
    <script>

      const template1 =
        (
          "abcdefghijklmnopqrstuvwxyz" +
          "ABCDEFGHIJKLMNOPQRSTUVWXYZ" +
          "!#$%&()=~|`{}[]@+;:*<>/?\\_-"
        ).split("");


      document.getElementById('gen').addEventListener('click', async ()=>{
        const pass = document.getElementById('pass').value;
        run(pass);
      });

      async function run(pass){
        let count1 = 0;
        let passworld;
        while(true){
          const expect1 = indexToString(count1, template1);
          const expect2 = await sha256Hex(expect1);
          document.getElementById("log1").innerHTML = expect1;
          document.getElementById("log2").innerHTML = expect2;
          if(pass == expect2){
            passworld = expect1;
            break;
          }
          count1++;
          await delay(1);
        }
        document.getElementById("log1").innerHTML = "見つかりました！！";
        document.getElementById("log2").innerHTML = passworld;
      }

      function indexToString(index, chars){
        const base = chars.length;
        let result = "";
        do{
          result = chars[index % base] + result;
          index = Math.floor(index / base) - 1;
        }while(index >= 0);
        return result;
      }

      function delay(ms){
        return new Promise(resolve => setTimeout(resolve, ms));
      }

      async function sha256Hex(text){
        const enc = new TextEncoder();
        const data = enc.encode(text);
        const hashBuffer = await crypto.subtle.digest('SHA-256', data);
        const hashArray = Array.from(new Uint8Array(hashBuffer));
        return hashArray.map(b=>b.toString(16).padStart(2,'0')).join('');
      }
    </script>
  </body>
</html>
